<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/lazy-imports/lazy-imports-mixin.html">

<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="../gobandgo-animated-pages/gobandgo-animated-pages.html">

<link rel="import" href="../gobandgo-garagesale-signup-address-page/gobandgo-garagesale-signup-address-page.html">

<dom-module id="gobandgo-garagesale-signup-page">

    <link rel="lazy-import" href="../gobandgo-garagesale-signup-marker-page/gobandgo-garagesale-signup-marker-page.html" group="marker-page">

    <template>
        <style>
             :host {
                @apply --layout-vertical;
            }

            #signup-pages {
                @apply --layout-flex;
                @apply --layout-vertical;
            }

            .page {
                @apply --layout-flex;
            }
        </style>

        <gobandgo-animated-pages id="signup-pages" selected="[[_page]]" attr-for-selected="name">
            <gobandgo-garagesale-signup-address-page on-address-exists="_handleAddressExists" on-address-resolved="_handleAddressResolved"
                name="address-page" class="page"></gobandgo-garagesale-signup-address-page>
            <gobandgo-garagesale-signup-marker-page on-marker-submitted="_handleMarkerSubmitted" address-data="[[_addressData]]" name="marker-page"
                class="page"></gobandgo-garagesale-signup-marker-page>
        </gobandgo-animated-pages>

    </template>

    <script>
        class GobandgoGarageSaleSignUpPage extends Polymer.LazyImportsMixin(Polymer.Element) {
            static get is() {
                return 'gobandgo-garagesale-signup-page';
            }

            static get properties() {
                return {
                    _page: {
                        type: String,
                        value: 'address-page'
                    },
                    _addressData: Object,
                    _finalMessage: String
                }
            }

            _handleAddressResolved(evt) {
                this._addressData = evt.detail;
                this.importLazyGroup('marker-page').then(() => {
                    this._page = 'marker-page';
                });
            }

            _handleAddressExists(evt) {
                this._addressData = evt.detail;
                this.importLazyGroup('marker-page').then(() => {
                    this._page = 'marker-page';
                });
            }

            _handleMarkerSubmitted(evt) {
                this._addressData = evt.detail;
                this.importLazyGroup('marker-page').then(() => {
                    this._page = 'marker-page';
                });
            }

        }

        window.customElements.define(GobandgoGarageSaleSignUpPage.is, GobandgoGarageSaleSignUpPage);
    </script>
</dom-module>